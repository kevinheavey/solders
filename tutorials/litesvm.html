<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LiteSVM &mdash; solders 0.27.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api_reference/index.html" />
    <link rel="prev" title="RPC helpers" href="rpc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            solders
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Solders</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="keypairs.html">Keypairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="pubkeys.html">Pubkeys</a></li>
<li class="toctree-l2"><a class="reference internal" href="transactions.html">Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpc.html">RPC helpers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">LiteSVM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#minimal-example">Minimal example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-programs">Deploying programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-travel">Time travel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-arbitrary-accounts">Writing arbitrary accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copying-accounts-from-a-live-environment">Copying Accounts from a live environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-features">Other features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#when-should-i-use-solana-test-validator">When should I use <code class="docutils literal notranslate"><span class="pre">solana-test-validator</span></code>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-platforms">Supported platforms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">solders</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">LiteSVM</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/kevinheavey/solders/blob/main/docs/tutorials/litesvm.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="litesvm">
<h1>LiteSVM<a class="headerlink" href="#litesvm" title="Permalink to this heading"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">solders.litesvm</span></code> is the Python wrapper for <a class="reference external" href="https://github.com/LiteSVM/litesvm">LiteSVM</a>. It brings best-in-class Solana testing
to Python, giving you a powerful, fast and ergonomic way to test Solana programs.</p>
<p>For a standard testing workflow, LiteSVM offers an experience superior to <code class="docutils literal notranslate"><span class="pre">solana-test-validator</span></code> (slow, unwieldy)
and the old <code class="docutils literal notranslate"><span class="pre">solders.bankrun</span></code> module (reasonably fast and powerful, but inherits a lot of warts from <code class="docutils literal notranslate"><span class="pre">solana-program-test</span></code>).</p>
<section id="minimal-example">
<h2>Minimal example<a class="headerlink" href="#minimal-example" title="Permalink to this heading"></a></h2>
<p>This example just transfers lamports from Alice to Bob without loading
any programs of our own.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">solders.keypair</span><span class="w"> </span><span class="kn">import</span> <span class="n">Keypair</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.litesvm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LiteSVM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.message</span><span class="w"> </span><span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.pubkey</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pubkey</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.system_program</span><span class="w"> </span><span class="kn">import</span> <span class="n">transfer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.transaction</span><span class="w"> </span><span class="kn">import</span> <span class="n">VersionedTransaction</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_transfer</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">receiver</span> <span class="o">=</span> <span class="n">Pubkey</span><span class="o">.</span><span class="n">new_unique</span><span class="p">()</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">LiteSVM</span><span class="p">()</span>
    <span class="n">payer</span> <span class="o">=</span> <span class="n">Keypair</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">airdrop</span><span class="p">(</span><span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="mi">1_000_000_000</span><span class="p">)</span>
    <span class="n">blockhash</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">latest_blockhash</span><span class="p">()</span>
    <span class="n">transfer_lamports</span> <span class="o">=</span> <span class="mi">1_000_000</span>
    <span class="n">ixs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">transfer</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;from_pubkey&quot;</span><span class="p">:</span> <span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span>
                <span class="s2">&quot;to_pubkey&quot;</span><span class="p">:</span> <span class="n">receiver</span><span class="p">,</span>
                <span class="s2">&quot;lamports&quot;</span><span class="p">:</span> <span class="n">transfer_lamports</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="o">.</span><span class="n">new_with_blockhash</span><span class="p">(</span><span class="n">ixs</span><span class="p">,</span> <span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="n">blockhash</span><span class="p">)</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">VersionedTransaction</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="p">[</span><span class="n">payer</span><span class="p">])</span>
    <span class="n">client</span><span class="o">.</span><span class="n">send_transaction</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
    <span class="n">balance_after</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_balance</span><span class="p">(</span><span class="n">receiver</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">balance_after</span> <span class="o">==</span> <span class="n">transfer_lamports</span>
</pre></div>
</div>
<p>Note: by default the <code class="docutils literal notranslate"><span class="pre">LiteSVM</span></code> instance includes some core programs such as
the System Program and SPL Token.</p>
</section>
<section id="deploying-programs">
<h2>Deploying programs<a class="headerlink" href="#deploying-programs" title="Permalink to this heading"></a></h2>
<p>Most of the time we want to do more than just mess around with token transfers -
we want to test our own programs.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to pull a Solana program from mainnet or devnet, use the <code class="docutils literal notranslate"><span class="pre">solana</span> <span class="pre">program</span> <span class="pre">dump</span></code> command from the Solana CLI.</p>
</div>
<p>To add a compiled program to our tests we can use the <code class="docutils literal notranslate"><span class="pre">add_program_from_file</span></code> method.</p>
<p>Here’s an example using a [simple program](<a class="reference external" href="https://github.com/solana-labs/solana-program-library/tree/bd216c8103cd8eb9f5f32e742973e7afb52f3b81/examples/rust/logging">https://github.com/solana-labs/solana-program-library/tree/bd216c8103cd8eb9f5f32e742973e7afb52f3b81/examples/rust/logging</a>)
from the Solana Program Library that just does some logging:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">solders.instruction</span><span class="w"> </span><span class="kn">import</span> <span class="n">AccountMeta</span><span class="p">,</span> <span class="n">Instruction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.keypair</span><span class="w"> </span><span class="kn">import</span> <span class="n">Keypair</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.litesvm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LiteSVM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.message</span><span class="w"> </span><span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.pubkey</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pubkey</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.transaction</span><span class="w"> </span><span class="kn">import</span> <span class="n">VersionedTransaction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.transaction_metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransactionMetadata</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_logging</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">program_id</span> <span class="o">=</span> <span class="n">Pubkey</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;Logging111111111111111111111111111111111111&quot;</span><span class="p">)</span>
    <span class="n">ix</span> <span class="o">=</span> <span class="n">Instruction</span><span class="p">(</span>
        <span class="n">program_id</span><span class="p">,</span>
        <span class="nb">bytes</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]),</span>
        <span class="p">[</span><span class="n">AccountMeta</span><span class="p">(</span><span class="n">Pubkey</span><span class="o">.</span><span class="n">new_unique</span><span class="p">(),</span> <span class="n">is_signer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_writable</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span>
    <span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">LiteSVM</span><span class="p">()</span>
    <span class="n">payer</span> <span class="o">=</span> <span class="n">Keypair</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">add_program_from_file</span><span class="p">(</span>
        <span class="n">program_id</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;tests/fixtures/spl_example_logging.so&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">airdrop</span><span class="p">(</span><span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="mi">1_000_000_000</span><span class="p">)</span>
    <span class="n">blockhash</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">latest_blockhash</span><span class="p">()</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="o">.</span><span class="n">new_with_blockhash</span><span class="p">([</span><span class="n">ix</span><span class="p">],</span> <span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="n">blockhash</span><span class="p">)</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">VersionedTransaction</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="p">[</span><span class="n">payer</span><span class="p">])</span>
    <span class="c1"># let&#39;s sim it first</span>
    <span class="n">sim_res</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">simulate_transaction</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">send_transaction</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">TransactionMetadata</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">sim_res</span><span class="o">.</span><span class="n">meta</span><span class="p">()</span> <span class="o">==</span> <span class="n">meta</span>
    <span class="k">assert</span> <span class="n">meta</span><span class="o">.</span><span class="n">logs</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Program log: static string&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">meta</span><span class="o">.</span><span class="n">compute_units_consumed</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10_000</span>
    <span class="p">)</span>  <span class="c1"># not being precise here in case it changes</span>
</pre></div>
</div>
</section>
<section id="time-travel">
<h2>Time travel<a class="headerlink" href="#time-travel" title="Permalink to this heading"></a></h2>
<p>Many programs rely on the <code class="docutils literal notranslate"><span class="pre">Clock</span></code> sysvar: for example, a mint that doesn’t become available until after
a certain time. With <code class="docutils literal notranslate"><span class="pre">litesvm</span></code> you can dynamically overwrite the <code class="docutils literal notranslate"><span class="pre">Clock</span></code> sysvar using <code class="docutils literal notranslate"><span class="pre">svm.set_clock()</span></code>.
Here’s an example using a program that panics if <code class="docutils literal notranslate"><span class="pre">clock.unix_timestamp</span></code> is greater than 100
(which is on January 1st 1970):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">solders.instruction</span><span class="w"> </span><span class="kn">import</span> <span class="n">Instruction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.keypair</span><span class="w"> </span><span class="kn">import</span> <span class="n">Keypair</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.litesvm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LiteSVM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.message</span><span class="w"> </span><span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.pubkey</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pubkey</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.transaction</span><span class="w"> </span><span class="kn">import</span> <span class="n">VersionedTransaction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.transaction_metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">FailedTransactionMetadata</span><span class="p">,</span> <span class="n">TransactionMetadata</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_set_clock</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">program_id</span> <span class="o">=</span> <span class="n">Pubkey</span><span class="o">.</span><span class="n">new_unique</span><span class="p">()</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">LiteSVM</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">add_program_from_file</span><span class="p">(</span>
        <span class="n">program_id</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;tests/fixtures/solders_clock_example.so&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">payer</span> <span class="o">=</span> <span class="n">Keypair</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">airdrop</span><span class="p">(</span><span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="mi">1_000_000_000</span><span class="p">)</span>
    <span class="n">blockhash</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">latest_blockhash</span><span class="p">()</span>
    <span class="n">ixs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Instruction</span><span class="p">(</span><span class="n">program_id</span><span class="o">=</span><span class="n">program_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">accounts</span><span class="o">=</span><span class="p">[])]</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="o">.</span><span class="n">new_with_blockhash</span><span class="p">(</span><span class="n">ixs</span><span class="p">,</span> <span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="n">blockhash</span><span class="p">)</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">VersionedTransaction</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="p">[</span><span class="n">payer</span><span class="p">])</span>
    <span class="c1"># set the time to January 1st 2000</span>
    <span class="n">initial_clock</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span>
    <span class="n">initial_clock</span><span class="o">.</span><span class="n">unix_timestamp</span> <span class="o">=</span> <span class="mi">1735689600</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_clock</span><span class="p">(</span><span class="n">initial_clock</span><span class="p">)</span>
    <span class="c1"># this will fail because it&#39;s not January 1970 anymore</span>
    <span class="n">bad_res</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">send_transaction</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bad_res</span><span class="p">,</span> <span class="n">FailedTransactionMetadata</span><span class="p">)</span>
    <span class="c1"># so let&#39;s turn back time</span>
    <span class="n">clock</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_clock</span><span class="p">()</span>
    <span class="n">clock</span><span class="o">.</span><span class="n">unix_timestamp</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_clock</span><span class="p">(</span><span class="n">clock</span><span class="p">)</span>
    <span class="n">ixs2</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Instruction</span><span class="p">(</span>
            <span class="n">program_id</span><span class="o">=</span><span class="n">program_id</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;foobar&quot;</span><span class="p">,</span>  <span class="c1"># unused, this is just to dedup the transaction</span>
            <span class="n">accounts</span><span class="o">=</span><span class="p">[],</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="n">msg2</span> <span class="o">=</span> <span class="n">Message</span><span class="o">.</span><span class="n">new_with_blockhash</span><span class="p">(</span><span class="n">ixs2</span><span class="p">,</span> <span class="n">payer</span><span class="o">.</span><span class="n">pubkey</span><span class="p">(),</span> <span class="n">blockhash</span><span class="p">)</span>
    <span class="n">tx2</span> <span class="o">=</span> <span class="n">VersionedTransaction</span><span class="p">(</span><span class="n">msg2</span><span class="p">,</span> <span class="p">[</span><span class="n">payer</span><span class="p">])</span>
    <span class="c1"># now the transaction goes through</span>
    <span class="n">good_res</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">send_transaction</span><span class="p">(</span><span class="n">tx2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">good_res</span><span class="p">,</span> <span class="n">TransactionMetadata</span><span class="p">)</span>
</pre></div>
</div>
<p>See also: <code class="docutils literal notranslate"><span class="pre">svm.warp_to_slot()</span></code>, which lets you jump to a future slot.</p>
</section>
<section id="writing-arbitrary-accounts">
<h2>Writing arbitrary accounts<a class="headerlink" href="#writing-arbitrary-accounts" title="Permalink to this heading"></a></h2>
<p>LiteSVM lets you write any account data you want, regardless of
whether the account state would even be possible.</p>
<p>Here’s an example where we give an account a bunch of USDC,
even though we don’t have the USDC mint keypair. This is
convenient for testing because it means we don’t have to
work with fake USDC in our tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">solders.account</span><span class="w"> </span><span class="kn">import</span> <span class="n">Account</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.litesvm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LiteSVM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.pubkey</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pubkey</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.token</span><span class="w"> </span><span class="kn">import</span> <span class="n">ID</span> <span class="k">as</span> <span class="n">TOKEN_PROGRAM_ID</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.token.associated</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_associated_token_address</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">solders.token.state</span><span class="w"> </span><span class="kn">import</span> <span class="n">TokenAccount</span><span class="p">,</span> <span class="n">TokenAccountState</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_infinite_usdc_mint</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">Pubkey</span><span class="o">.</span><span class="n">new_unique</span><span class="p">()</span>
    <span class="n">usdc_mint</span> <span class="o">=</span> <span class="n">Pubkey</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v&quot;</span><span class="p">)</span>
    <span class="n">ata</span> <span class="o">=</span> <span class="n">get_associated_token_address</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">usdc_mint</span><span class="p">)</span>
    <span class="n">usdc_to_own</span> <span class="o">=</span> <span class="mi">1_000_000_000_000</span>
    <span class="n">token_acc</span> <span class="o">=</span> <span class="n">TokenAccount</span><span class="p">(</span>
        <span class="n">mint</span><span class="o">=</span><span class="n">usdc_mint</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
        <span class="n">amount</span><span class="o">=</span><span class="n">usdc_to_own</span><span class="p">,</span>
        <span class="n">delegate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">state</span><span class="o">=</span><span class="n">TokenAccountState</span><span class="o">.</span><span class="n">Initialized</span><span class="p">,</span>
        <span class="n">is_native</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">delegated_amount</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">close_authority</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">LiteSVM</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_account</span><span class="p">(</span>
        <span class="n">ata</span><span class="p">,</span>
        <span class="n">Account</span><span class="p">(</span>
            <span class="n">lamports</span><span class="o">=</span><span class="mi">1_000_000_000</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">token_acc</span><span class="p">),</span>
            <span class="n">owner</span><span class="o">=</span><span class="n">TOKEN_PROGRAM_ID</span><span class="p">,</span>
            <span class="n">executable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">raw_account</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_account</span><span class="p">(</span><span class="n">ata</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">raw_account</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">raw_account_data</span> <span class="o">=</span> <span class="n">raw_account</span><span class="o">.</span><span class="n">data</span>
    <span class="k">assert</span> <span class="n">TokenAccount</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">raw_account_data</span><span class="p">)</span><span class="o">.</span><span class="n">amount</span> <span class="o">==</span> <span class="n">usdc_to_own</span>
</pre></div>
</div>
</section>
<section id="copying-accounts-from-a-live-environment">
<h2>Copying Accounts from a live environment<a class="headerlink" href="#copying-accounts-from-a-live-environment" title="Permalink to this heading"></a></h2>
<p>If you want to copy accounts from mainnet or devnet, you can use the <code class="docutils literal notranslate"><span class="pre">solana</span> <span class="pre">account</span></code> command in the Solana CLI to save account data to a file.</p>
</section>
<section id="other-features">
<h2>Other features<a class="headerlink" href="#other-features" title="Permalink to this heading"></a></h2>
<p>Other things you can do with <code class="docutils literal notranslate"><span class="pre">litesvm</span></code> include:</p>
<ul class="simple">
<li><p>Changing the max compute units and other compute budget behaviour using the <code class="docutils literal notranslate"><span class="pre">with_compute_budget</span></code> method.</p></li>
<li><p>Disable transaction signature checking using <code class="docutils literal notranslate"><span class="pre">svm.with_sigverify(false)</span></code>.</p></li>
<li><p>Find previous transactions using the <code class="docutils literal notranslate"><span class="pre">get_transaction</span></code> method.</p></li>
</ul>
</section>
<section id="when-should-i-use-solana-test-validator">
<h2>When should I use <code class="docutils literal notranslate"><span class="pre">solana-test-validator</span></code>?<a class="headerlink" href="#when-should-i-use-solana-test-validator" title="Permalink to this heading"></a></h2>
<p>While <code class="docutils literal notranslate"><span class="pre">litesvm</span></code> is faster and more convenient, it is also less like a real RPC node.
So <code class="docutils literal notranslate"><span class="pre">solana-test-validator</span></code> is still useful when you need to call RPC methods that LiteSVM
doesn’t support, or when you want to test something that depends on real-life validator behaviour
rather than just testing your program and client code.</p>
<p>In general though it is recommended to use <code class="docutils literal notranslate"><span class="pre">litesvm</span></code> wherever possible, as it will make your life
much easier.</p>
</section>
<section id="supported-platforms">
<h2>Supported platforms<a class="headerlink" href="#supported-platforms" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">litesvm</span></code> is supported on Linux x64 and MacOS targets. If you find a platform that is not supported
but which can run the <code class="docutils literal notranslate"><span class="pre">litesvm</span></code> Rust crate, please open an issue.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rpc.html" class="btn btn-neutral float-left" title="RPC helpers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api_reference/index.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kevin Heavey.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>